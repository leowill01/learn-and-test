## ------------------------------------------------------------------------
library(vcfR)
library(tidyverse)


## ------------------------------------------------------------------------
library(pinfsc50)
pkg = "pinfsc50"
vcf_file = system.file("extdata", "pinf_sc50.vcf.gz", package = pkg)
dna_file = system.file("extdata", "pinf_sc50.fasta", package = pkg)
gff_file = system.file("extdata", "pinf_sc50.gff", package = pkg)


## ------------------------------------------------------------------------
vcf = read.vcfR(vcf_file, verbose=F)


## ------------------------------------------------------------------------
library("ape")
dna = read.dna(dna_file, format = "fasta")


## ------------------------------------------------------------------------
gff = read.table(gff_file, sep = "\t", quote = "")


## ------------------------------------------------------------------------
chrom = create.chromR(name="Supercontig", vcf = vcf, seq = dna, ann = gff)


## ------------------------------------------------------------------------
plot(chrom)


## ------------------------------------------------------------------------
chrom = masker(chrom, min_QUAL = 1, min_DP = 300, max_DP = 700, min_MQ = 59.9, max_MQ = 60.1)
plot(chrom)


## ------------------------------------------------------------------------
chrom = proc.chromR(chrom, verbose = T)
plot(chrom)


## ------------------------------------------------------------------------
chromoqc(chrom, dp.alpha = 20)


## ------------------------------------------------------------------------
chromoqc(chrom, xlim=c(5e+05, 6e+05))


## ------------------------------------------------------------------------
data(vcfR_example)
vcf


## ------------------------------------------------------------------------
# vcf@meta %>% head
vcf@meta[1:7]
# strwrap(vcf@meta[1:7])


## ------------------------------------------------------------------------
queryMETA(vcf)


## ------------------------------------------------------------------------
queryMETA(vcf, element = "DP")


## ------------------------------------------------------------------------
queryMETA(vcf, element = "FORMAT=<ID=DP", nice = F)


## ------------------------------------------------------------------------
getFIX(vcf) %>% head

